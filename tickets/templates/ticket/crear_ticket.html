{% extends 'base.html' %}
{% load static %}
{% block title %}Tickets{% endblock %}
{% block content %}
<div class="ui blue ribbon label"><h3>Crear Ticket</h3></div>
<span></span>
<p></p>

<form method="post" enctype="multipart/form-data" class="ui fluid form">
    {% csrf_token %}
    {{form}}
    <p></p>
    <button type="submit" class="ui fluid blue button">Guardar</button>
</form>
<script>
    $(document).ready(function() {
        $('#id_categoría').on('change', function() {
            const id_categoría = $(this).val();
            console.log('Categoría seleccionada:', id_categoría);
            $.ajax({
                url: 'cargar_subcategorias',
                data: {
                    'id_categoría': id_categoría
                },
                dataType: 'json',
                success: function(data) {
                    console.log(data);
                    const subcategoríaSelect = $('#id_subcategoría');
                    subcategoríaSelect.empty();
                    $.each(data, function(index, subcategoría) {
                        subcategoríaSelect.append($('<option>', {
                            value: subcategoría.id_subcategoría,
                            text: subcategoría.nombre_subCat
                        }));
                    });
                }
            });
        });
    });
    </script>
{% endblock %}